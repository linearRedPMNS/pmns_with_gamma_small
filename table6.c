#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <time.h>
#include <gmp.h>

#include "structs.h"
#include "eccoptimizedcode.h"
#include "pmns.h"
#include "bench.h"

int main(void)
{
	time_t seed;
	srand((unsigned) (time(&seed)));
	
	uint64_t cycles;
	uint64_t gmpcycles[4], lincycles[4], spacycles[4];
	
	uint64_t nbrepet = 120; // Must be multiple of 3.
	// For this table, we reduce it because of the larger sizes.
	
	mp_limb_t hp1024n18[] = {0xfffffffffffffffd, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xa41f5f91be5aa0ff, 
	0x59f4975e6e7fffde, 0xf8a4088f95c22801, 0x42308a3237a9ce3c, 0x0973fe726096f6f5, 0x8005fd5a7c1f4221, 0, 0};
	setpmnsparams(18, 128393340029763584, 3);
	setpmnssparseinv(6191712471246438400u, 6191712471246438400u, 12297829382473034411u);
	cycles = do_bench(pmns_doublesparse_mult, 18, 128393340029763586, nbrepet);
	printf("DoubleSparse 1024: %ld cycles\n", cycles);
	spacycles[0] = cycles;
	printf("Correct: %ld/%d\n", checkPmns(18, 128393340029763586, 128393340029763584, hp1024n18, pmns_doublesparse_mult), LOOPCHKNMB);
	
	nbrepet = 60;
	
	mp_limb_t hp2002n36[] = {0xfffffffffffffffd, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0x221a1a0fffffffff, 0x1b00e0f69344a6f9, 0xe7eb21de88bdf067, 0x42a91509ab8b6d35, 0xeff3078b77ad9e8e, 
	0x96579ca9148a6565, 0xe7d89281b4897744, 0xe1e9065ed40e9b4e, 0x7ccbdf0ddebd6744, 0x2b7e04d3107d5722, 0x7b5f60d3cb873cfd, 
	0x5767dd89eaa54cb5, 0x0e695b2f5a1ca5dc, 0x200b7, 0, 0, 0, 0};
	setpmnsparams(36, 53984294346948608, 3);
	setpmnssparseinv(6166909456018833408u, 6166909456018833408u, 12297829382473034411u);
	cycles = do_bench(pmns_doublesparse_mult, 36, 53984294346948610, nbrepet);
	printf("DoubleSparse 2002: %ld cycles\n", cycles);
	spacycles[1] = cycles;
	printf("Correct: %ld/%d\n", checkPmns(36, 53984294346948610, 53984294346948608, hp2002n36, pmns_doublesparse_mult), LOOPCHKNMB);
	
	nbrepet = 30;
	
	mp_limb_t hp3979n72[] = {0x0000000000000003, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000,
	 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 
	 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 
	 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 
	 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 
	 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 
	 0x0000000000000000, 0x0000000000000000, 0xf4c6def2c2322100, 0x1f3bb1d75fbf062f, 0x8f73ec76a35822b9, 0xd3bff90e9d565683, 
	 0x6d20e490742904d8, 0x84b831a6d1a25d0b, 0x19bbc04f262226a3, 0x22375d79143ea97e, 0xdf927db9eb5dfbf1, 0xfcdc966b90f0fa1e, 
	 0xa1e5422406a75dc0, 0x88ca56c0b26774e5, 0x50dfdfa005d6efdc, 0x145ec2a253bbe538, 0xe22ea57417b56aa9, 0xc58152b92196c021, 
	 0xd86b2d64b54e519c, 0xae58a5a768dc3065, 0x29711b41447a1638, 0x0548fb9c1275e78c, 0x181148a4009e107c, 0xeaf1ca03c2f0d393, 
	 0x156a5cae2a3a028b, 0x3edf133cf2feceb2, 0xad305bbfc9944055, 0x402, 0, 0, 0, 0, 0, 0, 0, 0, 0};
	setpmnsparams(72, 42847255169859584, -3);
	setpmnssparseinv(12283546964083081216u, 12283546964083081216u, 6148914691236517205u);
	cycles = do_bench(pmns_doublesparse_mult, 72, 42847255169859586, nbrepet);
	printf("DoubleSparse 3797: %ld cycles\n", cycles);
	spacycles[2] = cycles;
	printf("Correct: %ld/%d\n", checkPmns(72, 42847255169859586, 42847255169859584, hp3979n72, pmns_doublesparse_mult), LOOPCHKNMB);
	
	nbrepet = 15;
	
	mp_limb_t hp7813n144[] = {0xfffffffffffffffd, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 
	0xffffffffffffffff, 0x1a7f276dab15c300, 0x1d8fd589d42e42d0, 0xa76b418db4b8261d, 0xcccfc1ad8788cde1, 0x9cad827fee264c9a, 
	0x77d68ecfa1a20068, 0xd8ea0041db0c2110, 0xe47fe875bbb2b2e3, 0xcf1e2eab22ea1ebf, 0x4aa0e0d8a8511ae1, 0x1b633e70ef7d5352, 
	0x45a0b1cde43a78f7, 0xf934ca2ab98b93e8, 0xb199f41a1f7b7177, 0x3321734ee94a555e, 0x081f1b2ff81a0cdf, 0x336c04014f1a83c6, 
	0xf57eaabb3446ea63, 0x7fe000b3146aa8e1, 0x82887d64310af743, 0xe1f47384e6aed48f, 0x6798c03fb691895f, 0x774b28d20e31e750, 
	0x63ad63651a5ac78f, 0x513a28b8c308fd6c, 0x5341fcda1524f9b9, 0xcf178e951aa068cf, 0x112f936f3238f68a, 0xf59b286f08b0b465, 
	0xa1c9d214afbac55b, 0x9dc8fa0283518287, 0x4988383301e19441, 0xd819655068a2c17b, 0x5386ca7d5022483f, 0x134bb006bd183d1d, 
	0x8e872c0311e7ae8f, 0xb4232ab6c58f57d3, 0x1190c22d583e0685, 0xccb4fadc22df5384, 0xeccfc252b3113070, 0x90dbc9cbd23435c1, 
	0x343acd73502dbc80, 0x57a9b8c7b291d4c4, 0x52ad632098614408, 0xb83f72569eeb1caf, 0x28d0dda99927fb47, 0xfc6eff9a0e212bb7, 
	0x327b35bd5abea0fa, 0xba99d4f8c8434dd8, 0x197bc95e9c2c3e1b, 0x10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
	setpmnsparams(144, 21423773613817856, 3);
	setpmnssparseinv(6156055949107789824u, 6156055949107789824u, 12297829382473034411u);
	cycles = do_bench(pmns_doublesparse_mult, 144, 21423773613817858, nbrepet);
	printf("DoubleSparse 7813: %ld cycles\n", cycles);
	spacycles[3] = cycles;
	printf("Correct: %ld/%d\n", checkPmns(144, 21423773613817858, 21423773613817856, hp7813n144, pmns_doublesparse_mult), LOOPCHKNMB);
	
	nbrepet = 120;
	
	mp_limb_t p1024n18[] = {0xca3ffffffffffffd, 0xe30a250d648179b5, 0x6e25ae70de9d8e50, 0xd9814927b2f988da, 0x353250dbdd6cbc7b, 
	0xc4ae935a78326d81, 0xff6de169cee3ec0c, 0x726cf9af1a998fe1, 0xef39af68e106b1c4, 0xb01f283dbf96ee71, 0x60bfae49433a02c2, 
	0x8a82b237e332c521, 0x612e370d9f2182f4, 0xa8358fa90eb831f5, 0x2351686d6f7d99f1, 0x800000000000121c, 0, 0};
	setpmnsparams(18, 128392036321333912, 3);
	setpmnslastcol((uint64_t[]) {14777811577278387541u, 17202986827636974712u, 16594554963584227136u, 11441603784583695872u, 
	8784845234927980544u, 4042679155270057984u, 9835149679119302656u, 281146902729195520u, 6599425285450366976u, 13831636012037570560u, 
	11701684711658094592u, 12996042782488395776u, 9584298067385909248u, 6622032528897212416u, 9944849576768831488u, 1985770776321589248u, 
	16759301588329168896u, 10554185726742757376u, });
	cycles = do_bench(pmns_linearred_mult, 18, 128392036321333914, nbrepet);
	printf("LinearRed 1024: %ld cycles\n", cycles);
	lincycles[0] = cycles;
	printf("Correct: %ld/%d\n", checkPmns(18, 128392036321333914, 128392036321333912, p1024n18, pmns_linearred_mult), LOOPCHKNMB);
	
	nbrepet = 60;
	
	mp_limb_t p2002n36[] = {0x4bf7ee2003f525ef, 0xb07d5f1ae02d2da2, 0x4daf68abed667349, 0xd4087b7ac1ba1938, 0x16b756a2cc8a430d, 0x8434a1b35f512b82, 0xaf9aca23b9dfb29f, 0x32f3f0487e941063, 0x0982677a4bcbbed5, 0xe942d405a4b65fd6, 0xe07b28a32013ba02, 0x56448722dd02b81e, 0x46481a82f7af9215, 0x8d698822f3757653, 0x215d1f623a2c4e1a, 0x7dffb36190ab3d6f, 0xc4cbb479d13341f6, 0x2488920576998a3c, 0x6f5ea865d7fec470, 0xb422eb26a790363c, 0x21d17172fed67f3f, 0x8821ae9738db04b1, 0xa2fa49b141a85047, 0xafbf603aa262f033, 0x900a69b9c9309801, 0x87c4ab8393677143, 0xe589b122b5f9258d, 0xc87081f00171fc05, 0x5e131702fe678e74, 0xd601268ece34b13f, 0x0000009255bd6c44, 0x20000, 0, 0, 0, 0};
	setpmnsparams(36, 53982201544867589, 2);
	setpmnslastcol((uint64_t[]) {15250604433334642959u, 10299793642239540811u, 16517828551022210167u, 6896658766029432659u, 
	8001466138574418335u, 454727721072793883u, 10002431507490923143u, 10744465595381999011u, 12851452005616310575u, 505587025941729003u, 
	17522891190585548695u, 14730497292076566259u, 12432809996856029119u, 13542461528058294203u, 16393462783021839271u, 
	3817221430652574531u, 144067946591733071u, 5669583757885442955u, 5945890720793112247u, 3731350434938991251u, 5188802463389018591u, 
	14427802189510390363u, 1832678568404361415u, 8891455533513301219u, 15942183374544432495u, 11704460521430299691u, 12100574842752981463u, 
	1171350995909012019u, 7043177114357063679u, 1442059195014373627u, 4638421009581795815u, 14663580608355904131u, 6944887134410363279u, 
	11584814222342424779u, 6419397713849213175u, 7640621354442812883u,});
	cycles = do_bench(pmns_linearred_mult, 36, 53982201544867590, nbrepet);
	printf("LinearRed 2002: %ld cycles\n", cycles);
	lincycles[1] = cycles;
	printf("Correct: %ld/%d\n", checkPmns(36, 53982201544867590, 53982201544867589, p2002n36, pmns_linearred_mult), LOOPCHKNMB);
	
	nbrepet = 30;
	
	mp_limb_t p3979n72[] = {0xfffffffffffffffd, 0x605b7386352ce0ff, 0x838b8e7b52810f87, 0xdc0e327b8b0f93ee, 0x184fb82562dfd389, 
	0xe6c227781c8f07ce, 0xf80537e9f88d35a3, 0xcc4dabcf99ca5c1b, 0xee6bd54060356010, 0x1abe9913bb54c53c, 0x858075eecae9b100, 
	0xff844814de528e91, 0xd7b64bb361c6785e, 0xc3ddee4528af280c, 0xc69a285649a9e169, 0xfab678840fd2d3ad, 0xcadbb4957050577c, 
	0x1cb640faff633c26, 0xffff579d30bbc852, 0x560f7eecb61dafe3, 0xb46c971bea6c0598, 0xe544043876ba7451, 0x15de374c2a09b605, 
	0xaab390780a805c04, 0x459f0fb57f2a1dda, 0x7de2e78d9cc2ce9d, 0xdeb4a2f972072cca, 0xa966a7a239367b5d, 0xd903a958004f782b, 
	0x961e8e7d4d2dbcfc, 0xbaef5493c997f84b, 0x24111f1aeda233df, 0xd8c89275eb9747c8, 0xed02020ce846c289, 0xa6c389cba651f189, 
	0x7603e4eb8cd009ed, 0x418b9d9c58073f70, 0x5300fd56dc932bf0, 0x44dfe26b476d5ce0, 0xf023db612454b25f, 0x063349b0f3d1ddc2, 
	0x3d1ef65e53cd20eb, 0xe6541255f692a283, 0xae3c888cc1a94f64, 0xa7349a6660a40872, 0x909b1de279d16508, 0xeb42c06505284566, 
	0x243e255bf9eb4b3a, 0xa6bdf404239d14bc, 0xd3963b2cd9786f5f, 0xed8fd94e1ce37812, 0xcaa53de8f2f4979c, 0xf20de97373ec0bda, 
	0xfaed6d28d3ac86b2, 0x1432873230fc2277, 0x5a27ec43ac139fbe, 0x7bc2782c5c006a88, 0x0700c0b56ad666c3, 0x68d09c349507ac1e, 
	0x0ea3cd830504abc1, 0x84e998279d01225f, 0x0000000275381f96, 0x400, 0, 0, 0, 0, 0, 0, 0, 0, 0};
	setpmnsparams(72, 42845701759941110, 3);
	setpmnslastcol((uint64_t[]) {6148914691236517205u, 12283547481886387374u, 7740245423465049396u, 3834112375703077880u, 
	14152382020799301712u, 6369542838332280032u, 16053828540506881856u, 4240225238657075072u, 18016587018908251392u, 15194791456471182848u, 
	17466091021646345216u, 9694116885378168832u, 9131572879234584576u, 12403147561776504832u, 4966377027592994816u, 17183355022492532736u, 
	834078115009724416u, 14803804887593123840u, 8773747734910074880u, 17865810224736632832u, 924289614876770304u, 9480620918022602752u, 
	18331768799641993216u, 15685723158432710656u, 4028231424946470912u, 4176152555224563712u, 2844777093378605056u, 4340475906045771776u, 
	1915184098255568896u, 14461634791855882240u, 4620755371227611136u, 15388324076560842752u, 4544337448007630848u, 18259974079358435328u, 
	16015313970197954560u, 17043177864075149312u, 2534084374551330816u, 11771667118158774272u, 8878036600169168896u, 4530981315192815616u, 
	1920280565236367360u, 16790525519534751744u, 15475692131644866560u, 12328876658810421248u, 952036332165660672u, 144361478680477696u, 
	17201287670509076480u, 1249608159106957312u, 7319756769360609280u, 5345209807735357440u, 9670354299871297536u, 9941696177420369920u, 
	14722267181874151424u, 2657123780148592640u, 5710564327505788928u, 7457960982925541376u, 17654110539292344320u, 7926335344172072960u, 
	12970366926827028480u, 17870283321406128128u, 5764607523034234880u, 16140901064495857664u, 4611686018427387904u, 9223372036854775808u, 
	0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u,});
	cycles = do_bench(pmns_linearred_mult, 72, 42845701759941112, nbrepet);
	printf("LinearRed 3979: %ld cycles\n", cycles);
	lincycles[2] = cycles;
	printf("Correct: %ld/%d\n", checkPmns(72, 42845701759941112, 42845701759941110, p3979n72, pmns_linearred_mult), LOOPCHKNMB/10);
	
	nbrepet = 15;
	
	mp_limb_t p7813n144[] = {0xd4d2f6d26463d343, 0xf050fe84eea151f9, 0xb73bac5d58fd51ef, 0x04a1f06d86b3740b, 0x2b4aa3a3d486dc03, 
	0xc9fbf7a38607c11e, 0x6dcc281e836797d0, 0xbcb3b4fb3f87ff2f, 0x72f4e28e9266270f, 0x1bc2de723ab61911, 0xe3fed44dc7e5cb52, 
	0x2d772e61d7d4b4f3, 0x319771629ade3e7b, 0x3bfa9c569a106596, 0xed0307788dd84281, 0xb033b37bbfa6bed1, 0x4d5d1bedeb1ccabe, 
	0xccb6ccdda7f67185, 0x1e66c783bba42648, 0x8041e1081c209b41, 0x1402de14af5256cb, 0xb31ef9da1ee5e384, 0xcab78c02ed176509, 
	0x38af93ebf81c47ec, 0xb47ecce54080cd68, 0x8c4fae9c04dc8f24, 0x76c6c1bbef5ef63a, 0xdf141267e0c372c2, 0x856b7ca5d818d9ca, 
	0x98f03c647cfb74fb, 0xf2d7be867e718640, 0x11cf424ca683cf45, 0xff2e70087d3daace, 0x74bb5639e493531e, 0xb3cff7378509ea82, 
	0xa3e5025a3515101c, 0xda6cff71439d57f5, 0x7c58b01dde500fbf, 0xc0b7027b52dd260b, 0x4c5b4e08b199db24, 0xee2a21037105078e, 
	0x5c129acf13f7dacc, 0x54c3b93462f4ad8d, 0x5bfd05cf215573c3, 0x51d80eac4a6fd718, 0xf7b48a80c66f84b0, 0x7636ba70c11112ef, 
	0x7d87befd4a6f6bdd, 0x4b4a3c542506d065, 0xaa6ee8df3cea402a, 0xa95de6fc0ee4cf36, 0xf5639b49a325d2fe, 0x79176e5f4e9d5340, 
	0xbaa6b2620a113848, 0xfee9b37bd1608cbf, 0xae3a1fa488e08ad5, 0x59114e473fd06665, 0xa8ddaf13696d6075, 0x142e1c1a4e0c8560, 
	0x490e578b4d5b12b9, 0x0686d00cccb15523, 0x8691931ea4b261d4, 0xd22fc2255f92cee8, 0x70ffe16a25d40147, 0x444e69b99ef439a2, 
	0x7201490c46fdc3d1, 0xaca97ca23e15e58c, 0x9a603370a65ae846, 0x0461da2eb0c42dcf, 0x51b674a6cbef7c14, 0xe01ec8603dd80e4f, 
	0xbbff0f4b58b96ef9, 0x267e9c7dc3b542c1, 0x06fc45ac2fdb2afb, 0x59d08d3ccf31be14, 0x16e9446a3e1d5546, 0x0f382e6aba93dbcc, 
	0xba09c7ac154d67a0, 0xd2e5c61837d45da5, 0x350b5fc03f58a024, 0xda0741e947a4ed9f, 0x55f2f062358e96a2, 0xf8150924bc8a34a8, 
	0x9d9367686c89b457, 0xee7473423fb519c8, 0x0f46a48909a9a706, 0x87a091bc452d1ec0, 0xaa37fc5a982d3c01, 0x2f355be6f3c64bce, 
	0x086f1a8b6a63b240, 0x2dcfc94281436212, 0xad38f2b9d81a3986, 0xdd8a3beed97d214c, 0x0564bf9daab67a4c, 0xa9339ef113fe14a2, 
	0xce2aead8efa9b2ca, 0x0b55cf68095e6f44, 0x3c540bc10b7a80f7, 0x8504186cfdf819a8, 0x578d2ee3b530d105, 0xd872cfd5e748e507, 
	0x8a3970d6c8255173, 0x23487019e71ba324, 0x79d8d41e08ab0540, 0x08d00515bc4b19b9, 0x9a265d71df04f091, 0x7a5437ae29422403, 
	0x53ee8c780f5d4ee3, 0x9b2466b1cbf7ca1d, 0xbc8e796588c8e3e0, 0xc75d92429d9f2c21, 0xc02b24bccee6756d, 0x81645c0debcfe838, 
	0x1192165e8b94d8e8, 0xd4bcdd47a5a20029, 0x63acc71193221ca3, 0xdc8372440eaf09c2, 0x638edcffd0130e1a, 0x1ae85c929f91887a, 
	0x3bc64d49644e136a, 0x1adeab3ccdd3ef60, 0x00000000088c290f, 0x10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
	setpmnsparams(144, 21422850879970461, -2);
	setpmnslastcol((uint64_t[]) {16426878044728185195u, 2212156419779420831u, 18091433318761373571u, 2929993605351860055u, 
	13700918053956199515u, 298378057306341327u, 10529921076218283507u, 8009812377790790151u, 1625600525809392203u, 1294010781201798143u, 
	2672049642688505699u, 10896944504178375607u, 8249204237692642107u, 16425017267360321327u, 10661940771029382099u, 3518799510313753703u, 
	17174203243078004523u, 11799136262150185311u, 16417422119294950211u, 6308891242540469271u, 8662836284670979611u, 3287486185345448591u, 
	15159933002629942707u, 13789630336203799239u, 17221986433288343563u, 4915988895294212799u, 9548294916872895267u, 8325325309940308087u, 
	8886189259394958587u, 2673516503168614895u, 3279936736730092435u, 17685196266051032359u, 10720583977440165099u, 11944200781216862239u, 
	16462262862049920771u, 9157750176987685079u, 9042444907668170715u, 4971084813399582031u, 12559177293202261363u, 17796839224580320135u, 
	11207100859257304523u, 12250597430483546495u, 16116981550188281571u, 5282349685399790903u, 13090610106208917179u, 
	10793819346609054895u, 15010902789687206739u, 1326419686049299943u, 18080992743157004971u, 6828343248898731743u, 15411097137117389507u, 
	14922835439858197911u, 7196237921249939867u, 13646230239923224591u, 7704772432728108339u, 16220426187666918471u, 16465916451422800779u, 
	12938527538772281407u, 9915277779415380643u, 17553962960112820727u, 17272348377418602619u, 11914139163358476143u, 7814087694427382547u, 
	5470094898131310247u, 7924462244294715499u, 11378523311726394783u, 3649276778264997507u, 7477177149679737431u, 18019577212042275675u, 
	17307512730780207823u, 3088275619236873459u, 17428686970178952455u, 1788414230960640331u, 306664429739347711u, 2490355818774451811u, 
	3219831178952609463u, 5264273284667591227u, 6678857892945771055u, 17592265927800689363u, 17195562468532641639u, 16080646064045688363u, 
	11396757236151008351u, 15342054057227528771u, 8303047766250389271u, 5466502191033595163u, 3591151874893104527u, 5859477041446554803u, 
	2648842055044046279u, 1185248786956896011u, 16851136322176681407u, 15016305975283657251u, 8094871226003975031u, 11429134040201505787u, 
	7119131571257191663u, 10412434890914689683u, 7978610470261135399u, 9043181780901352427u, 9619451931141991199u, 13287432547676837379u, 
	11781653332276859863u, 17104835092873785051u, 13873890617604534351u, 3843807980117017715u, 13699557796302835335u, 8488588418688101579u, 
	17283434143634025599u, 2981547596615331299u, 7570123875648157751u, 4995982779425078715u, 11567508588720557999u, 13985723856425714259u, 
	15404060018157338855u, 12385951013007708587u, 6109147454224959967u, 16898827603748401603u, 3530188036935325847u, 6019106709761677467u, 
	516247129780587279u, 4528578277909507123u, 5392376952718847815u, 4008816574701126283u, 233594279578321727u, 17157321446464250275u, 
	13117500605935580407u, 11238563431799750523u, 10245696877360308847u, 18212854476416696851u, 6325233699456145831u, 9071408757113618283u, 
	16446419727890356383u, 15187065557837757827u, 11459841281396395351u, 12790292412527882843u, 9885274638770771407u, 3452638384081683443u, 
	17233982278912016391u, 4575864500893747275u, 1435159812392421887u, 11173825108555089251u, 3049193192383685047u, 17308082381203403067u, 
	10610034361512043823u, 586802180106629587u, 10627632536556659303u,});
	cycles = do_bench(pmns_linearred_mult, 144, 21422850879970462, nbrepet);
	printf("LinearRed 7813: %ld cycles\n", cycles);
	lincycles[3] = cycles;
	printf("Correct: %ld/%d\n", checkPmns(144, 21422850879970462, 21422850879970461, p7813n144, pmns_linearred_mult), LOOPCHKNMB/10);
	
	nbrepet = 120;
	cycles = do_gmpbench(gmpmulmod2k, 361, 63, 16, nbrepet);
	printf("gmp 2^1023-361: %ld cycles\n", cycles);
	gmpcycles[0] = cycles;
	printf("Correct: %ld/%d\n", checkmodmul(361, 63, 16), LOOPCHKNMB);
	
	nbrepet = 60;
	cycles = do_gmpbench(gmpmulmod2k, 297, 18, 32, nbrepet);
	printf("gmp 2^2002-297: %ld cycles\n", cycles);
	gmpcycles[1] = cycles;
	printf("Correct: %ld/%d\n", checkmodmul(297, 18, 32), LOOPCHKNMB);
	
	nbrepet = 30;
	cycles = do_gmpbench(gmpmulmod2kbig, 3819, 11, 63, nbrepet);
	printf("gmp 2^3979-3819: %ld cycles\n", cycles);
	gmpcycles[2] = cycles;
	printf("Correct: %ld/%d\n", checkmodmul(3819, 11, 63), LOOPCHKNMB/10);
	
	nbrepet = 15;
	cycles = do_gmpbench(gmpmulmod2kbig, 241, 5, 123, nbrepet);
	printf("gmp 2^7813-241: %ld cycles\n", cycles);
	gmpcycles[3] = cycles;
	printf("Correct: %ld/%d\n", checkmodmul(241, 5, 123), LOOPCHKNMB/10);
	
	printf("\n================================================================================\n");
	printf("|  Method\\Prime size  |    1023     |    2002     |     3979     |    7813     |\n");
	printf("================================================================================\n");
	printf("| Corresp. PseudoMers | 2¹⁰²³ - 361 | 2²⁰⁰² - 297 | 2³⁹⁷⁹ - 3819 | 2⁷⁸¹³ - 241 |\n");
	printf("================================================================================\n");
	printf("|  DoubleSparse PMNS  |     %lu     |     %lu    |     %lu     |    %lu    |\n", spacycles[0], spacycles[1], spacycles[2], spacycles[3]);
	printf("================================================================================\n");
	printf("|   LinearRed PMNS    |     %lu     |     %lu    |     %lu     |    %lu    |\n", lincycles[0], lincycles[1], lincycles[2], lincycles[3]);
	printf("================================================================================\n");
	printf("| Adapted GMP low lvl |     %lu     |     %lu    |     %lu     |    %lu    |\n", gmpcycles[0], gmpcycles[1], gmpcycles[2], gmpcycles[3]);
	printf("================================================================================\n\n");
	
	return 0;
}
